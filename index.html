<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- PRIMARY META TAGS (Default for Home) -->
    <title>DM Explorer - Trending Videos & Search</title>
    <meta name="description" content="Discover the latest trending videos from around the world. Search and explore Dailymotion content easily with DM Explorer.">
    
    <!-- OPEN GRAPH / SOCIAL (Default) -->
    <meta property="og:type" content="video.other">
    <meta property="og:site_name" content="DM Explorer">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: "Averia Libre", system-ui; }
        .hidden-view { display: none !important; }
        /* This ensures that even without JS, there's some text for robots to "see" */
        #seo-fallback { position: absolute; left: -9999px; top: auto; width: 1px; height: 1px; overflow: hidden; }
    </style>
</head>
<body class="bg-gray-50">

    <!-- SEO FALLBACK FOR ROBOTS -->
    <div id="seo-fallback" aria-hidden="true">
        <h1>DM Explorer - Video Search Engine</h1>
        <p>Currently viewing trending videos and latest uploads on Dailymotion. Our platform allows you to search for high-quality video content across multiple categories including news, entertainment, and sports.</p>
        <nav>
            <a href="/?country=us">USA Trends</a>
            <a href="/?country=gb">UK Trends</a>
            <a href="/?country=in">India Trends</a>
        </nav>
    </div>

    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-4 flex flex-col md:flex-row items-center justify-between gap-4">
            <h1 class="text-2xl font-bold text-blue-600 cursor-pointer" onclick="navigateTo('/')">DM Explorer</h1>
            <div class="flex flex-1 max-w-xl w-full">
                <input id="search-input" type="text" placeholder="Search videos..." class="w-full border rounded-l-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 outline-none">
                <button onclick="handleSearch()" class="bg-blue-600 text-white px-6 py-2 rounded-r-lg hover:bg-blue-700">Search</button>
            </div>
        </div>
    </header>

    <main id="view-container" class="max-w-7xl mx-auto px-4 py-8">
        <!-- Content injected here -->
    </main>

    <!-- SCHEMA.ORG STRUCTURED DATA (Dynamically filled) -->
    <script id="video-schema" type="application/ld+json">{}</script>

    <script>
        // ROUTING ENGINE (Using History API for cleaner SEO URLs)
        function initRouter() {
            window.onpopstate = () => route();
            route();
        }

        async function route() {
            const params = new URLSearchParams(window.location.search);
            const videoId = params.get('v');
            const query = params.get('q');
            const country = params.get('country') || 'us';

            if (videoId) {
                renderPlayer(videoId);
            } else if (query) {
                renderList(`https://api.dailymotion.com/videos?search=${query}&limit=12&fields=id,title,thumbnail_360_url,owner.screenname`, `Results for "${query}"`);
            } else {
                renderList(`https://api.dailymotion.com/videos?sort=trending&country=${country}&limit=12&fields=id,title,thumbnail_360_url,owner.screenname`, `Trending in ${country.toUpperCase()}`);
            }
        }

        function navigateTo(path) {
            window.history.pushState({}, '', path);
            route();
        }

        function handleSearch() {
            const q = document.getElementById('search-input').value;
            if (q) navigateTo(`?q=${encodeURIComponent(q)}`);
        }

        // VIEW RENDERING
        async function renderList(url, title) {
            const container = document.getElementById('view-container');
            container.innerHTML = `<h2 class="text-xl font-bold mb-6">${title}</h2><div id="grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6">Loading...</div>`;
            
            try {
                const res = await fetch(url);
                const data = await res.json();
                const grid = document.getElementById('grid');
                grid.innerHTML = data.list.map(v => `
                    <div class="bg-white rounded-lg shadow-sm overflow-hidden cursor-pointer" onclick="navigateTo('?v=${v.id}')">
                        <img src="${v.thumbnail_360_url}" class="w-full aspect-video object-cover">
                        <div class="p-3">
                            <h3 class="font-bold text-sm line-clamp-2">${v.title}</h3>
                            <p class="text-xs text-gray-500 mt-1">${v['owner.screenname']}</p>
                        </div>
                    </div>
                `).join('');
                
                // Update SEO for the list page
                document.title = `${title} - DM Explorer`;
            } catch (e) { container.innerHTML = "Error loading videos."; }
        }

        async function renderPlayer(id) {
            const container = document.getElementById('view-container');
            container.innerHTML = "Loading video...";

            try {
                const res = await fetch(`https://api.dailymotion.com/video/${id}?fields=id,title,description,thumbnail_720_url,owner.screenname,created_time`);
                const v = await res.json();

                container.innerHTML = `
                    <div class="max-w-4xl mx-auto">
                        <div class="aspect-video bg-black rounded-xl overflow-hidden shadow-lg">
                            <iframe src="https://www.dailymotion.com/embed/video/${id}?autoplay=1" class="w-full h-full" allowfullscreen></iframe>
                        </div>
                        <h1 class="text-2xl font-bold mt-6">${v.title}</h1>
                        <p class="text-blue-600 font-bold">${v['owner.screenname']}</p>
                        <hr class="my-4">
                        <p class="text-gray-700">${v.description || 'No description available.'}</p>
                    </div>
                `;

                // CRITICAL FOR SEO: Update tags & JSON-LD
                document.title = `${v.title} - Watch on DM Explorer`;
                
                // Update Schema.org (Google reads this!)
                const schema = {
                    "@context": "https://schema.org",
                    "@type": "VideoObject",
                    "name": v.title,
                    "description": v.description,
                    "thumbnailUrl": v.thumbnail_720_url,
                    "uploadDate": new Date(v.created_time * 1000).toISOString(),
                    "embedUrl": `https://www.dailymotion.com/embed/video/${id}`
                };
                document.getElementById('video-schema').textContent = JSON.stringify(schema);

            } catch (e) { container.innerHTML = "Error loading video details."; }
        }

        window.onload = initRouter;
    </script>
</body>
</html>
